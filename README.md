# CelebrityFaces

На текущий момент проект находится на следующей стадии

1. Написан алгоритм приближенного поиска ближайших соседей. Реализация находится в директории myannoy. Алгоритм написан на c++, также написана обертка для него на cython. В файле research.ipynb можно найти некоторые эксперименты с этой реализацией. У алгоритма есть некоторые гиперпараметры, которые стоит подобрать, исходя из задачи. В зависимости от них алгоритм может работать быстрее(в ущерб качеству поиска). Описание алгоритма, параметров, экспериментов можно также найти в research.ipynb. В целом алгоритм можно настроить так, чтобы он работал в десятки раз быстрее реализованного на numpy точного поиска ближайших соседей. В данной задаче от нас требуется искать только одного ближайшего соседа. В такой ситуации алгоритм работает лучше.

2. Проведены некоторые эксперименты с лицами. Запустили facenet, извлекли эмбеддинги из aligned фотографий. По этим эмбеддингам попробовали поискать. Работает достаточно адекватно, хотя есть вопросы. Видно, что при таком использовании он находит в первую очеред похожие фотографии, а не похожих людей. Так, например, один раз попалась фотография тенисиста во время удара. У него был мяч на фотографии. В выдаче по этому эмбеддингу были все теннисисты с мячом перед головой. Кроме этого они не были ничем похожи на исходного человека. Стоит это потюнить, можно например добавить несколько слоев в эту сеть и обучить с использованием меток людей, воспользоваться pairwise loss. Можно обучить свою сеть с этим.

3. Разобрались с opencv. Он понадобится, чтобы на загружаемых фото выделять лица.

Осталось запустить flask  и собрать все вместе.
